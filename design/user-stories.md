| Epic                         | User story (INVEST)                                                                                                                               | Acceptance criteria (Done =)                                                                                                                                     |
| ---------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------- | ---------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **1. View mind‑map**         | _As a vault user_ I want to open any Markdown outline as a mind‑map so that I can grasp its structure at a glance.                                | ‑ Command “Open Mind‑Map” appears.<br>‑ A new pane shows nodes matching the outline hierarchy.<br>‑ Root node text equals FileName.                              |
|                              | _As a user_ I can pan & zoom with mouse/touchpad to navigate large maps.                                                                          | ‑ Scroll = zoom, drag blank space = pan.<br>‑ No visual tearing at 10k × 10k canvas.                                                                             |
| **2. Edit through the map**  | _As a user_ I press **Enter** on a node to create a sibling beneath it.                                                                           | ‑ New bullet inserted in source Markdown.<br>‑ Node appears instantly without refresh.                                                                           |
|                              | _As a user_ I press **Tab / Shift‑Tab** to indent/outdent the selected node.                                                                      | ‑ Tree updates; Markdown indent changes.<br>‑ Children move with parent.                                                                                         |
|                              | _As a user_ I drag a node onto another to re‑parent it.                                                                                           | ‑ Drop preview highlights valid targets.<br>‑ After drop, outline order reflects change.                                                                         |
| **3. Sync & integrity**      | _As a writer_ I want changes in the Markdown editor to propagate to the map within 500 ms so that both stay consistent.                           | ‑ Typing, indenting, deleting bullets in the editor updates the map live.<br>‑ No duplicate nodes or lost edits after 100 random ops.                            |
|                              | _As a user_ I can disable auto‑sync and trigger manual refresh.                                                                                   | ‑ Toggle in settings.<br>‑ Manual command “Refresh map” reloads without re‑opening pane.                                                                         |
| **4. Large outlines**        | _As a researcher_ I can collapse/expand sub‑trees to focus on a region.                                                                           | ‑ Click caret or hit **C** to toggle collapse.<br>‑ Hidden sub‑tree indicator shows child count.                                                                 |
|                              | _As a user_ the map remains interactive on outlines up to **5 000** nodes.                                                                        | ‑ Initial render < 1 s on M1 Mac.<br>‑ 60 fps pan/zoom measured with dev‑tools.                                                                                  |
| **5. Styling & context**     | _As a teacher_ I can colour‑code nodes by adding inline tags (`#exam`).                                                                           | ‑ Tag‑to‑color rules in settings.<br>‑ Map legend auto‑generated.                                                                                                |
|                              | _As a technical writer_ I can render inline LaTeX and code snippets inside nodes.                                                                 | ‑ `$E=mc^2$` shows MathJax.<br>‑ Triple‑backtick blocks monospace.                                                                                               |
| **6. Export & share**        | _As a user_ I can export the current view as **PNG** or **SVG** for slides.                                                                       | ‑ Command prompts for filename.<br>‑ Output matches what is on screen (respect zoom/ collapse).                                                                  |
| **7. Settings & shortcuts**  | _As a power user_ I can remap hotkeys and set default node font size & edge style.                                                                | ‑ Options in plugin settings tab.<br>‑ Hotkey change reflected without reload.                                                                                   |
| **8. Reliability & upgrade** | _As a maintainer_ I want CI tests (parser, serializer, drag) so refactors don’t break behaviour.                                                  | ‑ GitHub Actions runs `vitest` on PR.<br>‑ ≥ 80 % branch coverage.                                                                                               |
|                              | _As an open‑source contributor_ I can follow CONTRIBUTING.md to set up, build and run the plugin in ≤ 5 minutes.                                  | ‑ Fresh clone → `npm i && npm run dev` builds without error.                                                                                                     |
| **9 Images**                 | _As a writer_ I can embed an image in any node by adding Markdown image syntax `![alt](path)` so that visual concepts appear directly on the map. | • Parser detects `![…](…)` and stores `src`, `alt`.<br>• Renderer shows the image scaled to fit the node.<br>• Broken paths show a warning icon.                 |
| **10 Image resizing**        | _As a user_ I can drag node handles to resize an image (maintaining aspect ratio) and the new size persists.                                      | • Resize handle visible on hover.<br>• Width / height written to front‑matter or inline size tag (`{width=180}`).<br>• Reloading the file restores dimensions.   |
| **11 Full Image**            | _As a reader_ I can click a node’s image to open it full‑size in the Obsidian image viewer.                                                       | • Left‑click opens viewer (internal files) or external URL in default browser.                                                                                   |
| **12 External Links**        | _As a user_ I can add a hyperlink (`[text](link)`) to any node; clicking opens internal note or external page.                                    | • Parser stores `href`.<br>• Renderer underlines node text and shows link icon on hover.<br>• Cmd/Ctrl‑click opens in new leaf (internal) or browser (external). |
